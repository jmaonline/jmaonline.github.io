// For license information, see `RCc884ff2499c9400097c0ef030acdd754-source.js` within the same directory.
_satellite.__registerScript('/content/dam/public/dtm/wbc/launch-EN05fb55e8cfed49ba8f881781f47d5522/cf63e89810c4/c4e4fe46a295/642f4d86878a/RCc884ff2499c9400097c0ef030acdd754-source.min.js', "window.engagementManager={errorLog:[],version:\"1\",interestPrefix:\"Westpac\",interestValueLimit:15,keyDelimiter:\"|\",valueDelimiter:\":\",dateDelimiter:\"-\",interests:[\"brand\",\"section\",\"category\",\"family\",\"product\",\"segment\"],interestWeightings:{productCode:1},timeDecayRates:[{daysOlderThan:14,rate:.5}],debugLog:{_log:[],addEngagement:function(e,t,i,n,s){this._log.push({engagementType:e,engagementDimension:t,engagementValue:i,engagementWeight:n,dimensionValueScore:s})},addTimeDecay:function(e,t,i,n,s){this._log.push({engagementType:e,engagementDimension:t,engagementValue:i,engagementWeight:n,dimensionValueScore:s})},newInterest:function(e,t){this._log.push({engagementType:\"New interest\",engagementDimension:e,engagementValue:t,engagementWeight:\"\",dimensionValueScore:\"\"})},removeInterestValue:function(e,t,i){this._log.push({engagementType:\"Out of space : removing\",engagementDimension:e,engagementValue:t,engagementWeight:\"(\"+i+\")\",dimensionValueScore:\"\"})}},docCookies:{getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp(\"(?:(?:^|.*;)\\\\s*\"+encodeURIComponent(e).replace(/[\\-\\.\\+\\*]/g,\"\\\\$&\")+\"\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$\"),\"$1\"))||null},setItem:function(e,t,i,n,s,r){if(!e||/^(?:expires|max\\-age|path|domain|secure)$/i.test(e))return!1;var o=\"\";if(i)switch(i.constructor){case Number:o=i===Infinity?\"; expires=Fri, 31 Dec 9999 23:59:59 GMT\":\"; max-age=\"+i;break;case String:o=\"; expires=\"+i;break;case Date:o=\"; expires=\"+i.toUTCString()}return document.cookie=encodeURIComponent(e)+\"=\"+encodeURIComponent(t)+o+(s?\"; domain=\"+s:\"\")+(n?\"; path=\"+n:\"\")+(r?\"; secure\":\"\"),!0},removeItem:function(e,t,i){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+\"=; expires=Thu, 01 Jan 1970 00:00:00 GMT\"+(i?\"; domain=\"+i:\"\")+(t?\"; path=\"+t:\"\"),!0)},hasItem:function(e){return!!e&&new RegExp(\"(?:^|;\\\\s*)\"+encodeURIComponent(e).replace(/[\\-\\.\\+\\*]/g,\"\\\\$&\")+\"\\\\s*\\\\=\").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\\s*;)[^\\=]+)(?=;|$)|^\\s*|\\s*(?:\\=[^;]*)?(?:\\1|$)/g,\"\").split(/\\s*(?:\\=[^;]*)?;\\s*/),t=e.length,i=0;i<t;i++)e[i]=decodeURIComponent(e[i]);return e}},getDomainName:function(e){var t=e.split(\".\").reverse();return 3<=t.length&&t[1].match(/^(com|edu|gov|net|mil|org|nom|co|name|info|biz)$/i)?t[2]+\".\"+t[1]+\".\"+t[0]:t[1]+\".\"+t[0]},getInterestValue:function(e,t){for(var i=(this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\").split(this.keyDelimiter),n=0;n<i.length;n++){var s=i[n].split(this.valueDelimiter);if(s&&1<s.length&&s[0]==t)return parseInt(s[1])}return 0},getDateString:function(e){var t=new Date;e&&(t=new Date(e));var i=t.getDate(),n=t.getMonth(),s=t.getFullYear();return i+this.dateDelimiter+n+this.dateDelimiter+s},getDateFromDateString:function(e){if(e){var t=e.split(this.dateDelimiter);if(2<t.length){var i=t[0],n=t[1],s=t[2];return new Date(s,n,i)}}return!1},removeOldestInterestValue:function(e){for(var t=new Date,i=-1,n=\"\",s=0,r=(this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\").split(this.keyDelimiter),o=0;o<r.length;o++){var a=r[o].split(this.valueDelimiter);if(a&&2<a.length){var h=a[0],g=a[1],m=this.getDateFromDateString(a[2]);m&&m<t?(t=m,i=o,s=g,n=h):m&&m==t&&g<s&&(t=m,i=o,s=g,n=h)}}0<=i&&(this.debugLog.removeInterestValue(e,n,s),r.splice(i,2),this.docCookies.setItem(this.interestPrefix+this.version+e,r.join(this.keyDelimiter),Infinity,\"/\",this.getDomainName(window.location.hostname)))},setInterestValue:function(e,t,i){for(var n=this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\",s=n.split(this.keyDelimiter),r=!1,o=0,a=0;a<s.length;a++){var h=s[a].split(this.valueDelimiter);h&&1<h.length&&h[0]==t.toUpperCase()&&(r=!0,h[1]=i<o?o:i,h[2]=this.getDateString(),s[a]=h.join(this.valueDelimiter))}r?this.docCookies.setItem(this.interestPrefix+this.version+e,s.join(this.keyDelimiter),Infinity,\"/\",this.getDomainName(window.location.hostname)):(s.length>=2*this.interestValueLimit&&(this.removeOldestInterestValue(e),s=(n=this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\").split(this.keyDelimiter)),i<o&&(i=o),s.push(t.toUpperCase()+this.valueDelimiter+i+this.valueDelimiter+this.getDateString()),this.docCookies.setItem(this.interestPrefix+this.version+e,s.join(this.keyDelimiter)+this.keyDelimiter,Infinity,\"/\",this.getDomainName(window.location.hostname)))},differenceInDays:function(e,t){return e&&e.getTime&&t&&t.getTime?Math.ceil((t.getTime()-e.getTime())/864e5):0},getTimeDecayRate:function(e){for(var t=1,i=0;i<this.timeDecayRates.length;i++){var n=this.timeDecayRates[i];n.daysOlderThan&&n.rate&&e>n.daysOlderThan&&(t=n.rate)}return t},applyTimeDecay:function(e){for(var t=new Date,i=(this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\").split(this.keyDelimiter),n=i.length-1;0<=n;n--){var s=i[n].split(this.valueDelimiter);if(s&&2<s.length){var r=s[0],o=s[1],a=this.getDateFromDateString(s[2]);if(a){var h=this.differenceInDays(a,t),g=this.getTimeDecayRate(h);if(g<1){var m=Math.floor(o*g);m<=0?(this.debugLog.addTimeDecay(\"Time decay\",e,r,g,\"0 => removing\"),i.splice(n,2)):(this.debugLog.addTimeDecay(\"Time decay\",e,r,g,m),s[1]=m,s[2]=this.getDateString(),i[n]=s.join(this.valueDelimiter))}}}}this.docCookies.setItem(this.interestPrefix+this.version+e,i.join(this.keyDelimiter),Infinity,\"/\",this.getDomainName(window.location.hostname))},addEngagement:function(e,t,i){this.applyTimeDecay(t);var n=this.getInterestValue(t,i),s=1;\"number\"==typeof this.engagementWeightings[e]&&(s=this.engagementWeightings[e]);var r=n+s;this.setInterestValue(t,i,r),this.debugLog.addEngagement(e,t,i,s,r)},getHighestValueKey:function(e){for(var t=\"Unknown\",i=(this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\").split(this.keyDelimiter),n=0,s=0;s<i.length;s++){var r=i[s].split(this.valueDelimiter);r&&1<r.length&&parseInt(r[1])>n&&(n=parseInt(r[1]),t=r[0])}return t},getCurrentInterest:function(){for(var e=\"Unknown\",t=0,i=0;i<this.interests.length;i++){var n=this.interests[i],s=this.getHighestValueKey(n),r=this.getInterestValue(n,s),o=1;this.interestWeightings[n]&&(o=this.interestWeightings[n]);var a=r*o;t<=a&&(e=n,s,r,t=a)}return e},getCurrentInterestKey:function(){return this.getHighestValueKey(this.getCurrentInterest())},removeAllInterests:function(){for(var e=0;e<this.interests.length;e++){var t=this.interests[e];this.docCookies.removeItem(this.interestPrefix+this.version+t,\"/\",this.getDomainName(window.location.hostname))}},removeAllVersionInterests:function(e){for(var t=0;t<this.interests.length;t++){var i=this.interests[t];this.docCookies.removeItem(this.interestPrefix+e+i,\"/\",this.getDomainName(window.location.hostname))}},getInterestValuePosition:function(e,t){for(var i=(this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\").split(this.keyDelimiter),n=0;n<i.length;n++){var s=i[n].split(this.valueDelimiter);if(s&&1<s.length&&s[0]==t.toUpperCase())return Math.floor(n/2)}return-1},getNumOfInterestValues:function(e){var t=(this.docCookies.getItem(this.interestPrefix+this.version+e)||\"\").split(this.keyDelimiter);return Math.floor(t.length/2)}},_satellite.track(\"applySegmentationConfig\");");