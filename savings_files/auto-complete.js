!function(){"use strict";define(["jquery","components/web/utils/analytics"],function(a,b){function c(){this.$searchinput.bind("focus",this.options,a.proxy(d,this)),this.$searchinput.bind("blur",this.options,g),"true"==this.options.isPredictive?(this.$searchinput.bind("keydown",this.options,i),this.$searchinput.bind("keyup",this.options,k)):this.$searchinput.bind("keyup",this.options,r),this.$submitButton.bind("click",this.options,h),a(document).click(function(b){var c=a(b.target);c.parents(".js-search").length||a("#psearchSuggest").slideUp(90,function(){a(this).remove(),a(".js-search").find("input[type=text]").val(""),a(document.body).removeClass("has-activeSearch")})}),a(this.$form).submit(function(b){var c=/([!"\(\)\*;<>?@\[\]\\^`\{\}|~&=+:‘“\/_.$%'#\-,])/g,d=a(this).find(".js-search-field").val(),e=d.replace(c,"");a(this).find(".js-search-field").val(e),a(this).find(".js-search-field").val().length<2&&b.preventDefault()})}function d(b){var c=a(b.target),d=b.data;if(a(".suggest-wrapper").remove(),B=new Date,A=252,(""===c.val()||"Search..."===c.val())&&"true"==d.isPredictive){K=!1,L=!1;var g=a.proxy(f,this);setTimeout(function(){g(this.options)},100)}b.data.expand?(c.parent().addClass("focused").removeClass("focusedout"),c.parents("#"+b.data.id).addClass("active").removeClass("inactive"),c.css({color:"#333","background-color":"#FFF","float":"none"}),c.parents("#search-site-form").animate({width:A+128},H).prevAll(".retreivecards1").hide(),c.animate({width:"262px"}),a(".search-wrap").animate({width:"252px"},H,function(){s(c),R().fadeIn(G),c.css("width","250px"),L=!0,K&&L&&"true"==d.isPredictive&&e(d)})):(L=!0,K&&L&&"true"==d.isPredictive&&e(d));var h=c.attr("data-track");"undefined"!=typeof h&&h!==!1&&westpac.utils.analytics.triggerEvent("click",h)}function e(b){if(!("object"!=typeof B&&"number"==typeof B&&B<1e3)){var c=a("#"+b.id),d=a(c.find("form")[0]),e=(a(c.find("form").find('input[type="text"]')).parent(),j(d.parent()));e.offset.left+1,e.offset.top+e.height;K=!1,L=!1}}function f(b){var c=this;window.mostPopularCallback=function(b){"undefined"==typeof b||null==b||(a.each(b,function(b,c){a.extend(c,{disp:c.name,action:"#",cat:""})}),n(b,c.options,!0),K=!0,K&&L&&"true"==c.options.isPredictive&&e(c.options))},jQuery.ajax({type:"GET",url:E.topQueries,dataType:"jsonp",context:window,jsonp:!1,jsonpCallback:"mostPopularCallback",success:null})}function g(b){var c=a(this),d=(b.target,b.data);return B=new Date-B,A=88,M?(c.val()===c.attr("placeholder")&&c.val(""),c.focus(),M=!1,void b.stopPropagation()):void(b.data.expand&&(c.parent().addClass("focusedout").removeClass("focused"),c.css({color:"#fff"}),c.parent().css("border","none"),0!=a(this).val().replace(/^\s+|\s+$/g,"").length||N||(a("#searchButton").hide(),c.parents("#"+b.data.id).addClass("inactive").removeClass("active"),c.parents("#search-site-form").animate({width:"136px"},H,function(){c.width(A),a(".search-wrap").width(A),a("#"+d.id+" li:lt(2)").removeClass("inactive")}),setTimeout(function(){},150)),L=!1))}function h(b){var c,d=b.data,e=a("#"+d.id);a("#psearchSuggest").slideUp(90,function(){a(this).remove()}),e.length>0&&(c=a(e.find("form")[0])),c&&c.submit()}function i(b){if(40==b.which){N=!0,a("#psearchSuggest a:first").focus().addClass("focused");Q(b.data);return p(b.data,a("#psearchSuggest a:first").text()),b.preventDefault(),!1}N=!1}function j(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}function k(b){var c=b.data,d=a(this);if(null==E||"enabled"!=E.enabled)return!1;var e=this.value;if((9===b.which||40===b.which||38===b.which||13===b.which||27===b.which||8===b.which||32===b.which||48<=b.which&&b.which<=57||65<=b.which&&b.which<=90||97<=b.which&&b.which<=122)&&this.value.length>=E.length){var f=a("#"+b.data.id),g=a(f.find("form")[0]),h=(a(f.find("form").find('input[type="text"]')).parent(),j(g.parent()));h.offset.left+1,h.offset.top+h.height;if(!document.getElementById("psearchSuggest")){var i=w("div",{className:"suggest-wrapper",id:"psearchSuggest"});document.getElementById(c.id).appendChild(i)}var k=3===this.value.length?0:E.delay;void 0!==I&&clearTimeout(I),I=setTimeout(function(){I=void 0,jQuery.ajax({type:"GET",url:E.program+"?collection="+E.collection+"&partial_query="+e+"&show="+E.show+"&sort="+E.sort+"&alpha="+E.alpha+"&fmt="+("simple"==E.format?"json":"json++")+("undefined"!=typeof E.profile?"&profile="+E.profile:""),dataType:"jsonp",success:function(a){null==a||n(a,c,!1)}})},k)}s(d)}function l(a){var b={};J=[];for(var c=0,d=1,e=a.length;c<e;c++)"undefined"!=typeof a[c].cat&&(""==a[c].cat?a[c].cat="Suggested":"",b[a[c].cat]?b[a[c].cat].data.push(a[c]):(b[a[c].cat]={data:[],order:99},b[a[c].cat].data.push(a[c]),b[a[c].cat].order="Suggested"===a[c].cat?0:d++,b[a[c].cat].cat=a[c].cat,J.push(b[a[c].cat])));J.sort(function(a,b){return a.order-b.order})}function m(c,d,e,f,g,h,i,j){if(!c&&c.length<=0)return g;var k=w("div",{className:"suggest-heading"}),l=w("ul",{className:"suggest-section-list"}),m="Suggested"===d?i?c.length:c.length>4?4:c.length:c.length>2?2:c.length,n="mob-hide-term",p=g>3;i||(a(k).html(d),p&&(a(k).addClass(n),a(l).addClass(n)));for(var q=0;q<m;q++){var r=w("li",{className:h}),s=c[q].disp,t="Suggested"===d?q+1===m?c[0].disp:c[q+1].disp:"",u="Suggested"===d?q-1<0?c[0].disp:c[q-1].disp:"",v="searchsource=suggested-search-results&result-type=natural",x="",y="";"Suggested"===d&&(t=i?q+1===m?c[0].disp:c[q+1].disp:q+1===m?"":c[q+1].disp,u=q-1<0?c[0].disp:c[q-1].disp);var z=Q(j),A=a(z).closest("form");"Suggested"==d&&i?x="#":(v=v+"&kw="+a(z).val()+"&cat="+d+"&rank="+(q+1),x=c[q].action?c[q].action.indexOf("?")!=-1?c[q].action+"&"+v:c[q].action+"?"+v:""),y=a("<a href='"+x+"' class='"+d+"' "+(0===q?"data-suggest='yes'":"")+" data-currentPos='"+g+"'>"),a(y).bind("click",function(e){if(e.preventDefault(),!i&&"Suggested"!==d){a("<input />").attr("type","hidden").attr("name","searchtype").attr("value",i?"predicted":"suggested").appendTo(A),b.track({eventKey:"page:sitesearch:"+a(z).val()+":1:"+(new Date).getTime(),pageType:"sitesearch",searchTerm:a(z).val(),searchResults:c.length,pageNumber:"1"});var f=this;window.setTimeout(function(){window.location.href=a(f).attr("href")},500)}if(i||"Suggested"===d){var g=this.innerHTML;g=g.replace('<span class="highlight">',""),g=g.replace("</span>",""),a("<input />").attr("type","hidden").attr("name","searchtype").attr("value",i?"predicted":"suggested").appendTo(A),a(z).val(g),a(A).submit(),e.preventDefault()}return!1}),a(y).append(s),"Suggested"!=d||i||a(y).highlight(a(z).val(),"highlight"),a(y).bind("keydown",{displayNext:t,displayPrev:u,category:d,searchBoxId:j},function(b){o(b,parseInt(a(this).attr("data-currentPos"),11))}),a(r).append(y),i&&4===q&&a(r).addClass("no-border"),i&&a(r).addClass("pop"),g>5&&!i&&a(l).addClass(n),a(l).append(r),g++}return i||f.appendChild(k),f.appendChild(l),g}function n(b,c,d){if(b.length<1)return void a(".suggest-wrapper").hide();if(a("#psearchSuggest").html(""),!document.getElementById("psearchSuggest")){var e=w("div",{className:"suggest-wrapper",id:"psearchSuggest"});document.getElementById(c.id).appendChild(e)}l(b);var f=document.getElementById("psearchSuggest"),g=0,h=J.length>3?3:J.length;a.each(J,function(a){(d||!d&&h>0)&&(g=m(J[a].data,J[a].cat,J[a].cat,f,g,"Suggested"==J[a].cat?"ui-menu-item":"suggest-section-item",d,c)),h--}),d||a("#psearchSuggest").slideDown(50)}function o(b,c){var d=a(b.target),e=b.data,c=parseInt(a(d).attr("data-currentPos"),10),f=R(e.searchBoxId);switch(f.removeAttr("disabled"),f.removeClass("disabled"),b.which){case 9:return a("#psearchSuggest").slideUp(90),f.focus(),b.preventDefault(),!1;case 40:return p(e.searchBoxId,"Suggested"===e.category?e.displayNext:""),a('a[data-currentPos="'+(c+1)+'"]').length>0?(a('a[data-currentPos="'+c+'"]').removeClass("focused hasFocus selected"),a('a[data-currentPos="'+(c+1)+'"]').focus().addClass("focused hasFocus selected"),a('a[data-currentPos="'+c+'"]').parent().removeClass("li-focused"),a('a[data-currentPos="'+(c+1)+'"]').focus().parent().addClass("li-focused")):(a('a[data-currentPos="'+c+'"]').removeClass("focused hasFocus selected"),a('a[data-currentPos="0"]').focus().addClass("focused hasFocus selected"),a('a[data-currentPos="'+c+'"]').parent().removeClass("li-focused"),a('a[data-currentPos="0"]').focus().parent().addClass("li-focused")),b.preventDefault(),!1;case 38:return p(e.searchBoxId,"Suggested"===e.category?e.displayPrev:""),0!==c&&(a('a[data-currentPos="'+c+'"]').removeClass("focused hasFocus selected"),a('a[data-currentPos="'+(c-1)+'"]').focus().addClass("focused hasFocus selected"),a('a[data-currentPos="'+c+'"]').parent().removeClass("li-focused"),a('a[data-currentPos="'+(c-1)+'"]').focus().parent().addClass("li-focused")),b.preventDefault(),!1;case 13:break;case 27:q(),a("#psearchSuggest").slideUp(90);break;default:a(".suggest-wrapper a.focused").removeClass("focused hasFocus"),a("#headersearch").focus()}}function p(a,b){var c=Q(a);c.val(b)}function q(b){var c=a("#headersearch").data("typedQuery");return a("#headersearch").val(c),a("#headersearch").removeData("typedQuery"),!0}function r(b){return thisInput=a(this),27==b.keyCode?(thisInput.val("").blur(),void a("#psearchSuggest").slideUp(90)):void s(thisInput)}function s(b){b.val().length>1?a("#searchButton").removeClass("disabled").removeAttr("disabled"):a("#searchButton").addClass("disabled").attr("disabled","disabled")}function t(a){this.$searchinput.val(a)}function u(){return this.$searchinput.val()}function v(a){this.$searchinput.val(a)}function w(b,c,d){var e=document.createElement(b);if(null!==c&&void 0!==c)for(var f in c)switch(f.toLowerCase()){case"classname":e.className=c[f];break;case"colspan":e.colSpan=c[f];break;case"rowspan":e.rowSpan=c[f];break;case"htmlfor":e.htmlFor=c[f];break;default:e.setAttribute(f,c[f])}return"string"!=typeof d&&"object"!=typeof d||a(e).append(d),e}function x(a){a()}function y(b){function c(b){function c(){a(".listening-content").text(b.didntGetThat),a("<p />").appendTo(".listening-content"),a("<a />").attr("class","try-again").attr("tabindex","0").text(b.tryAgain).appendTo(".listening-content p"),a(".popup-speech-icon,.try-again,.header-speech-icon").removeClass("active")}var d=new webkitSpeechRecognition,h="";d.continuous=!1,d.interimResults=!0,d.lang="en-US",d.start(),d.onaudiostart=function(){a(".popup-speech-icon").addClass("recognitions-started"),a(".speech-animation").addClass("start"),a(".speech-animation .anim").addClass("ani-circular"),a(".listening-content").text(b.howCanIHelp),setTimeout(function(){""==h&&a(".listening-content").text(b.iAmListening)},1500)},d.onaudioend=function(){d.stop(),setTimeout(function(){a(".popup-speech-icon").removeClass("recognitions-started"),a(".speech-animation").removeClass("start"),a(".speech-animation .anim").removeClass("ani-circular"),""==h?c():(a("<input />").attr("type","hidden").attr("name","searchtype").attr("value","voice-enabled").appendTo(f),document.getElementById(f.attr("id")).submit())},500)},d.onspeechstart=function(){},d.onresult=function(b){h=b.results[0][0].transcript,a("#"+g.attr("id")).val(h),a(".listening-content").text(h)},d.onspeechend=function(){},d.onerror=function(a){d.stop(),d.abort(),""==h&&c()},d.onnomatch=function(a){c()},a(document).on("click",'.speech-support .modal-backdrop,.speech-support .modal[id^="voice-search"] .icon-cross',function(c){d.stop(),d.abort(),a(".listening-content").text(b.howCanIHelp),a(this).closest(".modal").attr("aria-hidden","true").removeClass("is-open"),a(".modal-backdrop").remove(),a(".popup-speech-icon,.try-again,.header-speech-icon").removeClass("active"),setTimeout(function(){void 0!=e&&("voice-search-header"==e&&(e="btn-header-search"),a("."+e).focus())},100)})}var d,e,f,g,h,i={howCanIHelp:"What are you searching",iAmListening:"I'm listening...",didntGetThat:"Didn't get that.",tryAgain:"Please try again"},j={};j=b?a.extend(!0,{},i,b):a.extend(!0,{},i),z(),a(".voice-search-header").length>0&&a(".voice-search-header").hasClass("js-rendered")&&a(this).removeClass("js-rendered"),a(".header-speech-icon").on("click",function(){d=a(this),d.hasClass("active")||(a(".popup-speech-icon,.try-again,.header-speech-icon").addClass("active"),f=d.closest("form"),g=f.find("input"),e=d.parent().attr("name"),setTimeout(function(){a("#"+e).focus()},100),c(j))}),a(".modal").on("click",".popup-speech-icon,.try-again",function(){d=a(this),d.hasClass("active")||(d.addClass("active"),h=d.closest(".modal").attr("id"),f=a("a[data-modal=#"+h+"]").closest("form"),g=f.find("input"),c(j))}),a("a.search-modal").keypress(function(b){13==b.which&&(d=a(this),a(".popup-speech-icon,.try-again,.header-speech-icon").addClass("active"),f=d.closest("form"),g=f.find("input"),e=d.attr("name"),a(".voice-modal").hasClass("is-open")||d.click(),setTimeout(function(){a("#"+e).focus()},100),c(j))}),a(".modal").on("keypress",".popup-speech-icon,.try-again",function(b){13==b.which&&(d=a(this),d.hasClass("active")||(d.addClass("active"),h=d.closest(".modal").attr("id"),f=a("a[data-modal=#"+h+"]").closest("form"),g=f.find("input"),c(j)))})}function z(){0==a(".modal.voice-modal-header").length&&a("footer").append("<div class='modal js-modalbody js-rendered voice-modal voice-modal-header' id='voice-search-header' tabindex='-1' role='dialog' aria-hidden='true' aria-labelledby='modal-header-title1' ><div class='modal-header'><button class='modal-header-close js-modalclose icon icon-size-sm icon-cross js-rendered'>Return to page</button><span class='modal-header-title' id='modal-header-title1' style='display: none;'>What are you looking for? Please speak now to search</span></div><div class='modal-body row'><div class='col-xs-12 col-sm-8'><div class='listening-content'></div></div><div class='col-xs-12 col-sm-4 bottom-margin5-xs'><div class='speech-animation'><div class='anim ani-circular'></div></div><span aria-label='Speak to search' class='icon icon-custom-mic popup-speech-icon' data-grunticon-embed tabindex='0'></span></div></div></div>"),0==a(".modal.voice-modal-main").length&&a(".search-box-container").length>0&&a("footer").append("<div class='modal js-modalbody voice-modal voice-modal-main' id='voice-search-main' tabindex='-1' role='dialog' aria-hidden='true' aria-labelledby='modal-header-title1'><div class='modal-header'><button class='modal-header-close js-modalclose icon icon-size-sm icon-cross'>Return to page</button><span class='modal-header-title' id='modal-header-title1' style='display: none;'>What are you looking for? Please speak now to search</span></div><div class='modal-body row top-margin3-md'><div class='col-xs-12 col-sm-8'><div class='listening-content'></div></div><div class='col-xs-12 col-sm-4 bottom-margin3-xs'><div class='speech-animation'><div class='anim ani-circular'></div></div><span aria-label='Speak to search' class='icon icon-custom-mic popup-speech-icon' data-grunticon-embed tabindex='0'></span></div></div></div>"),grunticon.embedSVG()}var A,B,C=function(b){this.options=b,this.$target=a("#"+this.options.id),O=this.$target,this.$target.length>0&&(this.$form=a(this.$target.find("form")[0]),this.$searchinput=a(this.$target.find("form").find('input[type="text"]')),this.$submitButton=a(this.$target.find("form").find('button[type="submit"]')),this.$btnsearch=a(this.$target.find("form").find('input[type="button"]')),F=this.$searchinput.attr("placeholder"),void 0!=this.options.isPredictive&&(D=this.options.isPredictive),void 0!=this.options.funnelbackConfig&&(E=this.options.funnelbackConfig)),P=this},D=!0,E=null,F="",G=500,H=500,I=void 0,J=[],K=!1,L=!1,M=!1,N=!1,O=null,P=null,Q=function(b){var c=a("#"+b.id);if(c.length>0){var d=(a(c.find("form")[0]),a(c.find("form").find('input[type="text"]')));return d}},R=function(b){var c=a("#"+b.id);if(c.length>0){var d=(a(c.find("form")[0]),a(c.find("form").find('[type="submit"]')));return d}},S=function(){this.$searchinput&&(this.bindEventHandlers(),O=document.getElementById(this.options.id),this.options.expand&&(this.$btnsearch.hide().addClass("disabled").attr("disabled","disabled"),this.$searchinput.addPlaceholder(F),this.$searchinput.attr({autocomplete:"off",autofill:"off"}),a("#"+this.options.id+" li:lt(2)").addClass("active-hide")),"true"==this.options.voiceConfig.enabled&&(Modernizr.addTest("speech-support",function(){return!(!window.webkitSpeechRecognition&&!window.SpeechRecognition)}),a("html").hasClass("speech-support")&&y(this.options.voiceConfig)))};return a(window).blur(function(b){a("#psearchSuggest").length}),a(window).focus(function(b){var c=a(document.activeElement);c&&"query"===c.attr("name")&&(M=!0,b.stopPropagation())}),a.fn.highlight=function(a,b){return this.each(function(){var c=this,d=new RegExp("("+a+")","ig"),e=c.innerHTML,f=e.replace(d,'<span class="'+b+'">$1</span>');c.innerHTML=f})},C.prototype={init:S,setInputText:t,getInputText:u,queryInputText:v,unitFuncton:x,bindEventHandlers:c},C})}();/* Version:19.0 16815c55e*/