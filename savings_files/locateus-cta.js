define(["jquery","underscore","components/locator/locator-app/4/0/locator-core-4.0"],function(a,b,c){"use strict";function d(a){return a?(a=a.replace("&",""),a=a.replace(/\s+/g,""),a.replace(/\s+/g,"")):""}function e(c,e){var f=p,g=b.extend({},{searchResult:e},{searchEntity:l[m.searchEntity],searchEntityLabel:m.searchEntityLabel,searchEntityType:m.searchEntityType,query:c,baseApp:m.locateUsApp,searchType:m.searchType,formatName:d}),h="";h=f(g),a(".js-results").html(h),a(".js-locate-us").removeClass("searching")}function f(b){var c=a.Deferred(),e="";return"branchOnly"===m.searchEntity&&m.searchEntityType&&""!==m.searchEntityType&&"None"!==m.searchEntityType?(e="&format=jsonp&staffRole="+d(m.searchEntityType)+"&types="+m.searchEntity,LocateUs.core.searchFilterString(e),LocateUs.core.searchType("findByLocationStaff"),m.searchType="staff"):(e="&format=jsonp&types="+m.searchEntity,LocateUs.core.searchFilterString(e),LocateUs.core.searchType("findByLocation"),m.searchType=""),o.searchFilterString=e,LocateUs.core.searchLocations(b).done(function(b){b&&b.results?c.resolve(b):b&&b.list&&a.isArray(b.list)&&b.list.length>0?("staff"===m.searchType&&(b.list=b.list.filter(function(b){return b&&b.staff&&a.isArray(b.staff)&&b.staff.length>0})),c.resolve(b)):c.reject({error:m.noResultsMessage})}).fail(function(a){a&&a.errors&&a.errors.length&&a.errors.length>0?c.resolve(a.errors[0].data):c.resolve({status:"ZERO_RESULTS"})}),c.promise()}function g(b){b&&""!==a.trim(b)&&(a("."+m.searchCta).attr("data-modal","#locateus-cta-modal"),a(".js-locate-us").removeClass("searching"),f(b).done(function(a){e(b,a)}).fail(function(a){e(b,a)}),a("#"+m.modalId).html(n({searchEntityLabel:m.searchEntityLabel})),GUI.modals.toggelModal(!1,a("#"+m.modalId),""),a(".js-locate-us").addClass("searching"))}function h(){a("."+m.searchCta).click(function(){var b=a("."+m.searchField).val();g(b)}),a("."+m.searchField).keypress(function(b){if(13===b.which){var c=a("."+m.searchField).val();g(c)}}),a("body").on("click",".js-multiple-address",function(b){var c=a(b.target),d=c.attr("data-address");d&&g(d)}),a("body").on("click",".js-modalclose",function(){GUI.modals.toggelModal(!0,a("#"+m.modalId),""),a("."+m.searchField).focus()}),a("body").on("click",".js-all-results",function(){var b=o.searchFilterString;b=b&&""!==b&&0===b.indexOf("&")?b.slice(1):"",b+="&searchInput="+a("."+m.searchField).val(),m.locateUsApp.indexOf("?")>-1?window.location.href=m.locateUsApp+"&"+b:window.location.href=m.locateUsApp+"#/?"+b})}function i(){window.LocateUs=window.LocateUs||{},LocateUs.core=new c,o.searchFilterString+=m.searchEntityType.replace(/\s/g,""),LocateUs.core.initialize(o,function(){h()})}function j(a){m=a?b.extend({},k,a):b.extend({},k),i()}var k={searchCta:"js-locateus-cta",searchField:"js-locateus-input",searchEntityLabel:"Lender",searchEntity:"branchOnly",searchEntityType:"Home Finance Manager",modalId:"locateus-cta-modal",locateUsApp:"/app.html#/",noResultsMessage:"Could not find any experts!",searchType:""},l={branchOnly:"Branches",instoreOnly:"In stores",branch:"Branches",atmOrBranch:"ATMs and branches",atm:"atms",advisoryOnly:"Advisory centers",branchAndAdvisory:"Branches and Advisory centers",All:"ATMs and branches"},m={},n=b.template('<div class="modal-header">  <button class="modal-header-close js-modalclose icon icon-size-sm icon-cross">Close modal and return to GUI page</button>  <span class="modal-header-title" id="modal-header-title1"><%= searchEntityLabel%></span></div><div class="modal-body js-locate-us" id="modal-bodyID">   <div class="locateus-stalker">       <span class="icon icon-size-sm icon-loading"></span>       <span>Searching...</span>   </div>   <div class="js-results"></div></div><div class="modal-footer"> <button type="button" class="btn btn-hero btn-soft js-modalclose">     Search again     <span class="modal-sronly">modal and return to page</span> </button> <button type="button" class="btn btn-primary js-all-results">     Go to all results     <span class="modal-sronly">Go to all results</span> </button></div>'),o={debug:!1,enableInfoWindow:!1,dataType:"json",enableCluster:!1,enableDirections:!1,gmapsVersion:"3.10",imagePath:"/assets/img/",searchInputId:"locateus-query",locationsResultsId:"locateus-results-output",servicePath:"//www.westpac.com.au/locator/LocateUsSearchService/",searchFilterString:"&format=jsonp&types=branchOnly&staffRole=",searchType:"findByLocation",maxSearchLimit:"3",animations:!0,geocodeOnly:!0},p=b.template(' <%if (searchResult.results && searchResult.results.length && searchResult.results.length > 0) {%>       <div class="did-you-mean">Did you mean?</div>      <ul class="lists lists-linklist">      <%for (var i=0, len=searchResult.results.length; i<len; i++){%>            <li>                  <a class="js-multiple-address" data-address="<%= searchResult.results[i].formatted_address%>" href="#">                        <%= searchResult.results[i].formatted_address%>                  </a>            </li>      <%}%>      </ul> <%} else if (searchResult.results && searchResult.status) {%>       <% if (searchResult.status === "ZERO_RESULTS") {%>           <p class="text-warning">Sorry, but we have no record of that address. Before trying again, please check that:<br/>- All street and city names are spelled correctly<br/>- Your address includes a city and state<br/>- You include a postcode.</p>       <% } else if (searchResult.status === "INVALID_REQUEST") {%>           <p class="text-warning">Sorry, we apologise but the service is temporarily unavailable. Please check back soon and try again.</p>       <% } else if (searchResult.status === "UNKNOWN_ERROR") {%>           <p class="text-warning">Sorry, but circumstances beyond our control has meant your request could not be processed. We sincerely apologise for any inconvenience. Please try again soon.</p>       <% } else if (searchResult.status === "OVER_QUERY_LIMIT") {%>           <p class="text-warning">Sorry, we apologise but the service is temporarily unavailable. Please check back soon and try again.</p>       <% } else if (searchResult.status === "ERROR") {%>           <p class="text-warning">Sorry, but there has been a Google system error. We could not process your request right now. Please try again later.</p>       <% }%> <%} else if (searchResult.error){%>     <p class="result-text">0 results for <span><strong><%= searchEntity%></strong></span> in or near <span><strong><%= query%></strong></span></p> <%} else if (searchResult.list){%>  <div class="container-fluid">  <div class="row"><div class="col-sm-12 search-result-text">     <p class="result-text">Results for <span><strong><%= searchEntity%></strong></span> in or near <span><strong><%= query%></strong></span></p>  </div></div>      <div class="row">    <%for (var i=0, len=searchResult.list.length; i<len; i++){%>          <div class="col-sm-12 search-result">       <% if (searchType === "staff") {%>             <%for (var j=0, jLen=searchResult.list[i].staff.length; j<jLen; j++){%>                     <div class="lender-details inline-block">                         <h6><%= searchResult.list[i].staff[j].firstname%>&nbsp;<%= searchResult.list[i].staff[j].lastname%></h6>                         <p>Direct Mobile:&nbsp;<a href="tel:<%= searchResult.list[i].staff[j].mobile%>"><%= searchResult.list[i].staff[j].mobile%></a></p>                         <p>Email:&nbsp;<a href="#"><%= searchResult.list[i].staff[j].email%></a></p>                         <p class="top-margin4-xs"><strong><%= searchResult.list[i].name%></strong></p>                         <p><%= searchResult.list[i].streetAddress%>&nbsp;<%= searchResult.list[i].suburb%>&nbsp;<%= searchResult.list[i].state%>&nbsp;<%= searchResult.list[i].postcode%></p>                         <p class="no-bottom-margin-xs">Branch:&nbsp;<a href="tel:<%= searchResult.list[i].phoneNumber%>"><%= searchResult.list[i].phoneNumber%></a></p>                     </div>             <%}%>       <% } else {%>                  <div class="lender-details inline-block">              <%if (searchResult.list[i].serviceProviderTypeName === "ATM" || searchResult.list[i].serviceProviderTypeName === "CEM" || searchResult.list[i].serviceProviderTypeName === "CDM") {%>                      <p><strong><%= searchResult.list[i].name%></strong></p>              <%} else if (searchResult.list[i].serviceProviderTypeName === "Branch") {%>                      <p><strong><%= searchResult.list[i].name%></strong></p>              <%}%>                      <p><%= searchResult.list[i].streetAddress%>&nbsp;<%= searchResult.list[i].suburb%>&nbsp;<%= searchResult.list[i].state%>&nbsp;<%= searchResult.list[i].postcode%></p>                      <%if (searchResult.list[i].phoneNumber) {%>                      <p class="no-bottom-margin-xs">Branch:&nbsp;<a href="tel:<%= searchResult.list[i].phoneNumber%>"><%= searchResult.list[i].phoneNumber%></a></p>                      <%}%>                  </div>          <%}%>          </div>    <%}%>      </div>  </div> <%}%>');return j});/* Version:19.0 16815c55e*/